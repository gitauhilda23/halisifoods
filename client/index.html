<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>Halisi foods & Recipes - Authentic Kenyan Recipe eBooks</title>
    <meta name="description" content="Discover authentic Kenyan recipe eBooks featuring Kenyan Recipes like ugali, nyama choma, and sukuma wiki. Instant digital downloads." />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&family=Montserrat:wght@500;600;700;800&display=swap" rel="stylesheet">
   
    <script src="https://js.paystack.co/v1/inline.js"></script>
  </head>
  <body class="font-sans relative">
    <!-- Main React App -->
    <div id="root"></div>

    <script type="module" src="/src/main.tsx"></script>

    <!-- PAYSTACK SINGLE PURCHASE -->
    <script>
      window.payWithPaystack = function({ email, phone, amount, recipeId, recipeName, metadata = {}, onSuccess, onClose }) {
        const handler = PaystackPop.setup({
          key: 'pk_live_b1bc14d3250387de5175b9ebb291d9101904c741',
          email: email,
          amount: amount * 100,
          currency: 'KES',
          ref: 'MFR_' + Date.now() + '_' + Math.floor(Math.random() * 1000000000),
          metadata: { recipeId, recipeName, phone, ...metadata },
          callback: function(response) {
            const finalUrl = metadata.pdfUrl || '#';
            if (finalUrl && finalUrl !== '#') onSuccess(finalUrl);
            else { alert('PDF not found. Contact support.'); onSuccess('#'); }
          },
          onClose: () => { console.log("Payment closed"); onClose?.(); }
        });
        handler.openIframe();
      };
    </script>

    <!-- PAYSTACK CART PURCHASE -->
    <script>
      window.payWithPaystackCart = function({ email, phone, items, onSuccess, onClose }) {
        const baseTotal = items.reduce((sum, i) => sum + i.amount, 0);
        const discount = items.length >= 3 ? 400 : items.length >= 2 ? 100 : 0;
        const finalAmount = Math.max(baseTotal - discount, 0);
        const handler = PaystackPop.setup({
          key: 'pk_live_b1bc14d3250387de5175b9ebb291d9101904c741',
          email: email,
          amount: finalAmount * 100,
          currency: 'KES',
          ref: 'MFR_CART_' + Date.now() + '_' + Math.floor(Math.random() * 1000000000),
          metadata: { phone, cart_size: items.length, discount, items: items.map(i => ({ id: i.recipeId, name: i.recipeName, price: i.amount })) },
          callback: function(response) { onSuccess([], finalAmount, discount); },
          onClose: () => { console.log("Cart payment closed"); onClose?.(); }
        });
        handler.openIframe();
      };
    </script>
  </body>
</html>